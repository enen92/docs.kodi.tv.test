<!-- HTML header for doxygen 1.9.2-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Kodi Documentation: teste</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<script type="text/javascript" src="../../doxygen-awesome-darkmode-toggle.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../Thumbnail-symbol-whitebg-small.jpg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Kodi Documentation<span id="projectnumber">&#160;20.0</span>
   </div>
   <div id="projectbrief">Kodi is an open source media player and entertainment hub.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('d4/db3/md_pages_teste.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">teste </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p ><img src="../../resources/banner_slim.png" alt="Kodi Logo" class="inline"/></p>
<h1><a class="anchor" id="autotoc_md60"></a>
Android build guide</h1>
<p >This guide has been tested with Ubuntu 16.04 (Xenial) x86_64. It is meant to cross-compile Kodi for Android using <b>../tools/depends/README.md "Kodi's unified depends build system"</b>. Please read it in full before you proceed to familiarize yourself with the build procedure.</p>
<p >It should work if you're using macOS. If that is the case, read <b><a href="#35-macos-specific-prerequisites">macOS specific prerequisites</a></b> first.</p>
<h2><a class="anchor" id="autotoc_md61"></a>
Table of Contents</h2>
<ol type="1">
<li><b><a href="#1-document-conventions">Document conventions</a></b></li>
<li><b><a href="#2-install-the-required-packages">Install the required packages</a></b></li>
<li><b><a href="#3-prerequisites">Prerequisites</a></b> <br  />
 3.1. <b><a href="#31-extract-android-sdk-and-ndk">Extract Android SDK and NDK</a></b> <br  />
 3.2. <b><a href="#32-configure-android-sdk">Configure Android SDK</a></b> <br  />
 3.3. <b><a href="#33-set-up-the-android-toolchain">Set up the Android toolchain</a></b> <br  />
 3.4. <b><a href="#34-create-a-key-to-sign-debug-apks">Create a key to sign debug APKs</a></b> <br  />
 3.5. <b><a href="#35-macos-specific-prerequisites">macOS specific prerequisites</a></b></li>
<li><b><a href="#4-get-the-source-code">Get the source code</a></b></li>
<li><b><a href="#5-build-tools-and-dependencies">Build tools and dependencies</a></b></li>
<li><b><a href="#6-build-binary-add-ons">Build binary add-ons</a></b></li>
<li><b><a href="#7-build-kodi">Build Kodi</a></b></li>
<li><b><a href="#8-package">Package</a></b></li>
<li><b><a href="#9-install">Install</a></b></li>
<li><b><a href="#10-debugging-kodi">Debugging Kodi</a></b></li>
</ol>
<h2><a class="anchor" id="autotoc_md62"></a>
1. Document conventions</h2>
<p >This guide assumes you are using <code>terminal</code>, also known as <code>console</code>, <code>command-line</code> or simply <code>cli</code>. Commands need to be run at the terminal, one at a time and in the provided order.</p>
<p >This is a comment that provides context: </p><div class="fragment"><div class="line">this is a command</div>
<div class="line">this is another command</div>
<div class="line">and yet another one</div>
</div><!-- fragment --><p ><b>Example:</b> Clone Kodi's current master branch: </p><div class="fragment"><div class="line">git clone https://github.com/xbmc/xbmc kodi</div>
</div><!-- fragment --><p >Commands that contain strings enclosed in angle brackets denote something you need to change to suit your needs. </p><div class="fragment"><div class="line">git clone -b &lt;branch-name&gt; https://github.com/xbmc/xbmc kodi</div>
</div><!-- fragment --><p ><b>Example:</b> Clone Kodi's current Krypton branch: </p><div class="fragment"><div class="line">git clone -b Krypton https://github.com/xbmc/xbmc kodi</div>
</div><!-- fragment --><p >Several different strategies are used to draw your attention to certain pieces of information. In order of how critical the information is, these items are marked as a note, tip, or warning. For example:</p>
<p ><b>NOTE:</b> Linux is user friendly... It's just very particular about who its friends are. <br  />
 <b>TIP:</b> Algorithm is what developers call code they do not want to explain. <br  />
 <b>WARNING:</b> Developers don't change light bulbs. It's a hardware problem.</p>
<p ><b><a href="#table-of-contents">back to top</a></b> | <b><a href="#1-document-conventions">back to section top</a></b></p>
<h2><a class="anchor" id="autotoc_md63"></a>
2. Install the required packages</h2>
<p >Install build dependencies needed to cross-compile Kodi for Android: </p><div class="fragment"><div class="line">sudo apt install autoconf build-essential curl default-jdk gawk git gperf lib32stdc++6 lib32z1 lib32z1-dev libcurl4-openssl-dev unzip zlib1g-dev</div>
</div><!-- fragment --><p> <b>NOTE:</b> If you're running a 32bit Debian/Ubuntu distribution, remove <code>lib32stdc++6 lib32z1 lib32z1-dev</code> from the command. <b>NOTE:</b> Gradle 7.0.2+ requires Jave Runtime 11+. Check java version by running <code>java --version</code>. If version is &lt; 11, set JAVA_HOME to java 11+ home directory._</p>
<p ><b><a href="#table-of-contents">back to top</a></b></p>
<h2><a class="anchor" id="autotoc_md64"></a>
3. Prerequisites</h2>
<p >Building Kodi for Android requires Android NDK revision 20b. For the SDK just use the latest available. Kodi CI/CD platforms currently use r21e for build testing and releases, so we recommend using r21e for the most tested build experience</p>
<ul>
<li><b><a href="https://developer.android.com/studio/index.html">Android SDK</a></b> (Look for <code>Get just the command line tools</code>)</li>
<li><b><a href="https://developer.android.com/ndk/downloads/index.html">Android NDK</a></b></li>
</ul>
<h3><a class="anchor" id="autotoc_md65"></a>
3.1. Extract Android SDK and NDK</h3>
<p >Create needed directories: </p><div class="fragment"><div class="line">mkdir -p $HOME/android-tools/android-sdk-linux/cmdline-tools</div>
</div><!-- fragment --><p >Extract Android SDK: </p><div class="fragment"><div class="line">unzip $HOME/Downloads/commandlinetools-linux-6200805_latest.zip -d $HOME/android-tools/android-sdk-linux/cmdline-tools</div>
</div><!-- fragment --><p ><b>NOTE:</b> Since we're using the latest SDK available, filename can change over time. Adapt the <code>unzip</code> command accordingly.</p>
<p >Extract Android NDK: </p><div class="fragment"><div class="line">unzip $HOME/Downloads/android-ndk-r21e-linux-x86_64.zip -d $HOME/android-tools</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md66"></a>
3.2. Configure Android SDK</h3>
<p >Before Android SDK can be used, you need to accept the licenses and configure it: </p><div class="fragment"><div class="line">cd $HOME/android-tools/android-sdk-linux/cmdline-tools/tools/bin</div>
<div class="line">./sdkmanager --sdk_root=$(pwd)/../.. --licenses</div>
<div class="line">./sdkmanager --sdk_root=$(pwd)/../.. platform-tools</div>
<div class="line">./sdkmanager --sdk_root=$(pwd)/../.. &quot;platforms;android-28&quot;</div>
<div class="line">./sdkmanager --sdk_root=$(pwd)/../.. &quot;build-tools;28.0.3&quot;</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md67"></a>
3.3. Create a key to sign debug APKs</h3>
<p >All packages must be signed. The following command will generate a self-signed debug key. If the result is a cryptic error, it probably just means a debug key already existed.</p>
<div class="fragment"><div class="line">keytool -genkey -keystore ~/.android/debug.keystore -v -alias androiddebugkey -dname &quot;CN=Android Debug,O=Android,C=US&quot; -keypass android -storepass android -keyalg RSA -keysize 2048 -validity 10000</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md68"></a>
3.4. macOS specific prerequisites</h3>
<ul>
<li><b><a href="http://www.oracle.com/technetwork/java/javase/downloads/index.html">Java Development Kit 11+ (JDK)</a></b> installed.</li>
<li>Normal macOS installations filesystem is case insensitive but compiling for Android requires a case sensitive filesystem. Generate a writeable hdd image and format it with hfs+ (case sensitive) issuing<ul>
<li>&lsquo;hdiutil create -type UDIF -fs 'Case-sensitive Journaled HFS+&rsquo; -size 20g -volname android-dev $HOME/android-dev.dmg`</li>
</ul>
</li>
<li>Whenever you want to compile/develop you need to mount the image<ul>
<li><code>open ~/android-dev.dmg</code></li>
</ul>
</li>
<li>Once you have your hdd image with case sensitive hfs+ file system execute all the steps inside of this filesystem. You need to adapt all paths in this guide so that they match your local environment. As an example here is a configure line that demonstrates possible paths:<ul>
<li><code>./configure --with-tarballs=/Users/Shared/xbmc-depends/tarballs --host=arm-linux-androideabi --with-sdk-path=/Volumes/android-dev/android/android-sdk-macosx --with-ndk-path=/Volumes/android-dev/android/android-ndk-r21e --prefix=/Volumes/android-dev/android/xbmc-depends</code></li>
</ul>
</li>
</ul>
<p ><b><a href="#table-of-contents">back to top</a></b> | <b><a href="#3-prerequisites">back to section top</a></b></p>
<h2><a class="anchor" id="autotoc_md69"></a>
4. Get the source code</h2>
<p >Change to your <code>home</code> directory: </p><div class="fragment"><div class="line">cd $HOME</div>
</div><!-- fragment --><p >Clone Kodi's current master branch: </p><div class="fragment"><div class="line">git clone https://github.com/xbmc/xbmc kodi</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md70"></a>
5. Build tools and dependencies</h2>
<p >Prepare to configure build: </p><div class="fragment"><div class="line">cd $HOME/kodi/tools/depends</div>
<div class="line">./bootstrap</div>
</div><!-- fragment --><p ><b>TIP:</b> Look for comments starting with <code>Or ...</code> and only execute the command(s) you need.</p>
<p >Configure build for aarch64: </p><div class="fragment"><div class="line">./configure --with-tarballs=$HOME/android-tools/xbmc-tarballs --host=aarch64-linux-android --with-sdk-path=$HOME/android-tools/android-sdk-linux --with-ndk-path=$HOME/android-tools/android-ndk-r21e --prefix=$HOME/android-tools/xbmc-depends</div>
</div><!-- fragment --><p >Or configure build for arm: </p><div class="fragment"><div class="line">./configure --with-tarballs=$HOME/android-tools/xbmc-tarballs --host=arm-linux-androideabi --with-sdk-path=$HOME/android-tools/android-sdk-linux --with-ndk-path=$HOME/android-tools/android-ndk-r21e --prefix=$HOME/android-tools/xbmc-depends</div>
</div><!-- fragment --><p >Or configure build for x86: </p><div class="fragment"><div class="line">./configure --with-tarballs=$HOME/android-tools/xbmc-tarballs --host=i686-linux-android --with-sdk-path=$HOME/android-tools/android-sdk-linux --with-ndk-path=$HOME/android-tools/android-ndk-r21e --prefix=$HOME/android-tools/xbmc-depends</div>
</div><!-- fragment --><p >Or configure build for x86_64: </p><div class="fragment"><div class="line">./configure --with-tarballs=$HOME/android-tools/xbmc-tarballs --host=x86_64-linux-android --with-sdk-path=$HOME/android-tools/android-sdk-linux --with-ndk-path=$HOME/android-tools/android-ndk-r21e --prefix=$HOME/android-tools/xbmc-depends</div>
</div><!-- fragment --><blockquote class="doxtable">
<p ><b>Note:</b> Android x86 and x86_64 are not maintained and are not 100% sure that everything works correctly! </p>
</blockquote>
<p>Build tools and dependencies: </p><div class="fragment"><div class="line">make -j$(getconf _NPROCESSORS_ONLN)</div>
</div><!-- fragment --><p ><b>TIP:</b> By adding <code>-j&lt;number&gt;</code> to the make command, you can choose how many concurrent jobs will be used and expedite the build process. It is recommended to use <code>-j$(getconf _NPROCESSORS_ONLN)</code> to compile on all available processor cores. The build machine can also be configured to do this automatically by adding <code>export MAKEFLAGS="-j$(getconf _NPROCESSORS_ONLN)"</code> to your shell config (e.g. <code>~/.bashrc</code>).</p>
<p ><b>WARNING:</b> Look for the <code>Dependencies built successfully.</code> success message. If in doubt run a single threaded <code>make</code> command until the message appears. If the single make fails, clean the specific library by issuing <code>make -C target/&lt;name_of_failed_lib&gt; distclean</code> and run <code>make</code>again.</p>
<p ><b><a href="#table-of-contents">back to top</a></b> | <b><a href="#5-build-tools-and-dependencies">back to section top</a></b></p>
<h2><a class="anchor" id="autotoc_md71"></a>
6. Build binary add-ons</h2>
<p >You can find a complete list of available binary add-ons <b><a href="https://github.com/xbmc/repo-binary-addons">here</a></b>.</p>
<p >Change to Kodi's source code directory: </p><div class="fragment"><div class="line">cd $HOME/kodi</div>
</div><!-- fragment --><p >Build all add-ons: </p><div class="fragment"><div class="line">make -j$(getconf _NPROCESSORS_ONLN) -C tools/depends/target/binary-addons</div>
</div><!-- fragment --><p >Build specific add-ons: </p><div class="fragment"><div class="line">make -j$(getconf _NPROCESSORS_ONLN) -C tools/depends/target/binary-addons ADDONS=&quot;audioencoder.flac pvr.vdr.vnsi audiodecoder.snesapu&quot;</div>
</div><!-- fragment --><p >Build a specific group of add-ons: </p><div class="fragment"><div class="line">make -j$(getconf _NPROCESSORS_ONLN) -C tools/depends/target/binary-addons ADDONS=&quot;pvr.*&quot;</div>
</div><!-- fragment --><p> For additional information on regular expression usage for ADDONS_TO_BUILD, view ADDONS_TO_BUILD section located at ../cmake/addons/README.md "Kodi add-ons CMake based buildsystem"</p>
<p ><b><a href="#table-of-contents">back to top</a></b></p>
<h2><a class="anchor" id="autotoc_md72"></a>
7. Build Kodi</h2>
<p >Configure CMake build: </p><div class="fragment"><div class="line">cd $HOME/kodi</div>
<div class="line">make -C tools/depends/target/cmakebuildsys</div>
</div><!-- fragment --><p ><b>TIP:</b> BUILD_DIR can be provided as an argument to cmakebuildsys. This allows you to provide an alternate build location. Change all paths onwards as required if BUILD_DIR option used. </p><div class="fragment"><div class="line">mkdir $HOME/kodi-build</div>
<div class="line">make -C tools/depends/target/cmakebuildsys BUILD_DIR=$HOME/kodi-build</div>
</div><!-- fragment --><p >Build Kodi: </p><div class="fragment"><div class="line">cd $HOME/kodi-build</div>
<div class="line">make -j$(getconf _NPROCESSORS_ONLN)</div>
</div><!-- fragment --><p ><b><a href="#table-of-contents">back to top</a></b></p>
<h2><a class="anchor" id="autotoc_md73"></a>
8. Package</h2>
<p >CMake generates a target called <code>apk</code> which will package Kodi ready for distribution.</p>
<p >Create package: </p><div class="fragment"><div class="line">make apk</div>
</div><!-- fragment --><p >Generated <code>apk</code> file will be inside <code>$HOME/kodi</code>.</p>
<p ><b><a href="#table-of-contents">back to top</a></b></p>
<h2><a class="anchor" id="autotoc_md74"></a>
9. Install</h2>
<p >Connect your Android device to your computer through USB and enable the <code>Unknown sources</code> option in your device settings.</p>
<p >Make sure <code>adb</code> is installed: </p><div class="fragment"><div class="line">sudo apt install adb</div>
</div><!-- fragment --><p >Install Kodi: </p><div class="fragment"><div class="line">cd $HOME/kodi-android</div>
<div class="line">adb devices</div>
<div class="line">adb -s &lt;device-id&gt; install -r &lt;generated-apk-name-here&gt;.apk</div>
</div><!-- fragment --><p >The <em>device-id</em> can be retrieved from the list returned by the <code>adb devices</code> command and is the first value in the row representing your device.</p>
<p ><b><a href="#table-of-contents">back to top</a></b></p>
<h2><a class="anchor" id="autotoc_md75"></a>
10. Debugging Kodi</h2>
<p >To be able to see what is happening while running Kodi you need to enable <code>USB debugging</code> in your device settings (already enabled in the Android Emulator).</p>
<p >Access the log output of your Android device: </p><div class="fragment"><div class="line">adb -s &lt;device-id&gt; logcat</div>
</div><!-- fragment --><p >Install a new build over the existing one: </p><div class="fragment"><div class="line">adb -e install -r images/xbmcapp-debug.apk</div>
</div><!-- fragment --><p >Launch Kodi on Android Emulator without the GUI: </p><div class="fragment"><div class="line">adb shell am start -a android.intent.action.MAIN -n org.xbmc.xbmc/android.app.NativeActivity</div>
</div><!-- fragment --><p >Kill a misbehaving Kodi: </p><div class="fragment"><div class="line">adb shell ps | grep org.xbmc | awk &#39;{print $2}&#39; | xargs adb shell kill</div>
</div><!-- fragment --><p >Filter logcat messages by a specific tag (e.g. <code>Kodi</code>): </p><div class="fragment"><div class="line">adb logcat -s Kodi:V</div>
</div><!-- fragment --><p >Enable CheckJNI (<b>before</b> starting the Kodi): </p><div class="fragment"><div class="line">adb shell setprop debug.checkjni 1</div>
</div><!-- fragment --><p ><b>NOTE:</b> These commands assume that current directory is <code>tools/android/packaging</code> and that the proper SDK/NDK paths are set.</p>
<p >GDB can be used to debug, though the support is rather primitive. Rather than using gdb directly, you will need to use ndk-gdb which wraps it. Do <b>not</b> trust the <code>-p/--project</code> switches, as they do not work. Instead you will need to <code>cd</code> to <code>tools/android/packaging/xbmc</code> and execute it from there. </p><div class="fragment"><div class="line">ndk-gdb --start --delay=0</div>
</div><!-- fragment --><p >This will open the installed version of Kodi and break. The warnings can be ignored as we have the appropriate paths already setup.</p>
<p ><b><a href="#table-of-contents">back to top</a></b> | <b><a href="#10-debugging-kodi">back to section top</a></b> </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.9.2-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Fri Dec 24 2021 14:07:44 for Kodi Documentation by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.2 </li>
  </ul>
</div>
<script type="text/javascript">
  // script for doxygen 1.9.1
  $(function() {
    toggleButton = document.createElement('doxygen-awesome-dark-mode-toggle')
    toggleButton.title = "Toggle Light/Dark Mode"
    $(document).ready(function(){
      document.getElementById("MSearchBox").parentNode.appendChild(toggleButton)
    })
    $(window).resize(function(){
      document.getElementById("MSearchBox").parentNode.appendChild(toggleButton)
    })
  })
</script>
</body>
</html>
