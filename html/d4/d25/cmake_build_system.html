<!-- HTML header for doxygen 1.9.2-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Kodi Docs: CMake build system</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<script type="text/javascript" src="../../doxygen-awesome-darkmode-toggle.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../Thumbnail-symbol-whitebg-small.jpg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Kodi Docs<span id="projectnumber">&#160;20.0</span>
   </div>
   <div id="projectbrief">Kodi is an open source media player and entertainment hub.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('d4/d25/cmake_build_system.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">CMake build system </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p ><img src="../../../resources/banner_slim.png" alt="Kodi Logo" class="inline"/></p>
<hr  />
<p>Welcome to Kodi's CMake Based Build System. CMake is a cross-platform tool for generating makefiles as well as project files used by IDEs. The current version of the build system is capable of building and packaging Kodi for the following platforms:</p>
<ul>
<li>Linux (several distros)</li>
<li>Windows</li>
<li>macOS, iOS and tvOS</li>
<li>Android</li>
<li>FreeBSD</li>
</ul>
<p >While the legacy build systems typically used in-source builds, it's recommended to use out-of-source builds with CMake. The necessary runtime dependencies such as dlls, skins and configuration files are copied over to the build directory automatically. Instructions are highly dependent on your operating system and target platform but we prepared a set of ../docs/README.md "build guides" for your convenience.</p>
<h1><a class="anchor" id="autotoc_md107"></a>
Build options</h1>
<p >Kodi supports a number of build options that can enable or disable functionality. These options must be set when running CMake with <code>-DENABLE_&lt;OPTION&gt;=&lt;ON|OFF|AUTO</code>. The default is <code>AUTO</code> which enables the option if a certain dependency is found. For example <a class="el" href="../../d3/df9/namespace_c_e_c.html">CEC</a> support is enabled if <code>libCEC</code> is available. <code>ON</code> forcefully enables the dependency and the CMake run will <b>fail</b> if the related dependency is not available. <code>OFF</code> will disable the feature.</p>
<p >Example for forcefully enabling <a class="el" href="../../d8/d70/namespace_v_a_a_p_i.html">VAAPI</a> and disabling <a class="el" href="../../d5/d02/namespace_v_d_p_a_u.html">VDPAU</a>: </p><div class="fragment"><div class="line">cmake ... -DENABLE_VAAPI=ON -DENABLE_VDPAU=OFF ...</div>
</div><!-- fragment --><p >Unfortunately, Kodi's CMake gazillion options are not fully documented yet. For more information and an updated list of options, please check the main <b><a href="../../../CMakeLists.txt">CMakeLists.txt</a></b>.</p>
<h1><a class="anchor" id="autotoc_md108"></a>
Buildsystem variables</h1>
<p >The buildsystem uses the following variables (which can be passed into it when executing cmake with the -D<code>&lt;variable-name&gt;=&lt;value&gt;</code> format) to manipulate the build process (see READMEs in sub-directories for additional variables):</p>
<ul>
<li><code>CMAKE_BUILD_TYPE</code> specifies the type of the build. This can be either <em>Debug</em> or <em>Release</em> (default is <em>Release</em>)</li>
<li><code>CMAKE_TOOLCHAIN_FILE</code> can be used to pass a toolchain file</li>
<li><code>ARCH_DEFINES</code> specifies the platform-specific C/C++ preprocessor defines (defaults to empty)</li>
</ul>
<h1><a class="anchor" id="autotoc_md109"></a>
Building</h1>
<p >To trigger the cmake-based buildsystem the following command must be executed with <code>&lt;path&gt;</code> set to this directory (absolute or relative) allowing for in-source and out-of-source builds</p>
<p ><code>cmake &lt;path&gt; -G &lt;generator&gt;</code></p>
<p >CMake supports multiple generators. See <a href="https://cmake.org/cmake/help/v3.1/manual/cmake-generators.7.html">here</a> for a list.</p>
<p >In case of additional options the call might look like this:</p>
<p >cmake <code>&lt;path&gt;</code> [-G <code>&lt;generator&gt;</code>] \ <br  />
 -DCMAKE_BUILD_TYPE=Release \ <br  />
 -DARCH_DEFINES="-DTARGET_LINUX" \ <br  />
 -DCMAKE_INSTALL_PREFIX="`&lt;path-to-install-directory`"</p>
<h1><a class="anchor" id="autotoc_md110"></a>
Tests</h1>
<p >Kodi uses Google Test as its testing framework. Each test file is scanned for tests and these are added to CTest, which is the native test driver for CMake.</p>
<p >This scanning happens at configuration time. If tests depend on generated support files which should not be scanned, then those support files should be added to the <code>SUPPORT_SOURCES</code> variable as opposed to <code>SOURCES</code> before calling <code>core_add_test</code>. You might want to do this where the generated support files would not exist at configure time, or if they are so large that scanning them would take up an unreasonable amount of configure time.</p>
<h1><a class="anchor" id="autotoc_md111"></a>
Extra targets</h1>
<p >When using makefile builds, a few extra targets are defined:</p>
<p ><code>make check</code> builds and executes the test suite.</p>
<p ><code>make check-valgrind</code> builds and executes the test suite with valgrind memcheck.</p>
<p ><code>make doc</code> builds the Doxygen documentation.</p>
<p >Code coverage (with Gcov, LCOV and Gcovr) can be built on Linux:</p>
<p >CMake has to be executed with <code>-DCMAKE_BUILD_TYPE=Coverage</code>.</p>
<p ><code>make coverage</code> generates an <a class="el" href="../../d4/d4e/namespace_h_t_m_l.html">HTML</a> code coverage report.</p>
<p ><code>make coverage_xml</code> generates an XML code coverage report.</p>
<h1><a class="anchor" id="autotoc_md112"></a>
Building binary addons</h1>
<p >Kodi's CMake build system integrates with the add-on build system if the GNU Makefile generator is used. This offers an easy way to build add-ons for packagers or Kodi developers who don't work on add-ons.</p>
<p >Build all add-ons: </p><div class="fragment"><div class="line">make binary-addons</div>
</div><!-- fragment --><p >Build specific add-ons: </p><div class="fragment"><div class="line">make binary-addons ADDONS=<span class="stringliteral">&quot;visualization.spectrum pvr.demo&quot;</span></div>
</div><!-- fragment --><p >Add-on developers can build single add-ons into the Kodi build directory so that the add-on can be tested with self-compiled specific versions of Kodi. </p><div class="fragment"><div class="line"><a class="code hl_function" href="../../de/d51/group__python__xbmcvfs.html#ga07a90f3afa1401bd289deb4be40c2489">mkdir</a> <a class="code hl_variable" href="../../d7/d66/_g_u_i_info_manager_8cpp.html#a59fe29cd9055981409819110c7b88cb5">pvr</a>.demo-<a class="code hl_namespace" href="../../d9/d45/namespacebuild.html">build</a></div>
<div class="line">cd <a class="code hl_variable" href="../../d7/d66/_g_u_i_info_manager_8cpp.html#a59fe29cd9055981409819110c7b88cb5">pvr</a>.demo-<a class="code hl_namespace" href="../../d9/d45/namespacebuild.html">build</a></div>
<div class="line">cmake -DCMAKE_BUILD_TYPE=Debug -DCMAKE_PREFIX_PATH=&lt;KODI_BUILD_DIR&gt;/<a class="code hl_namespace" href="../../d9/d45/namespacebuild.html">build</a> -DKODI_BUILD_DIR=&lt;KODI_BUILD_DIR&gt; &lt;<a class="code hl_variable" href="../../d7/d66/_g_u_i_info_manager_8cpp.html#a59fe29cd9055981409819110c7b88cb5">pvr</a>.demo-SRC&gt;</div>
<div class="line">make</div>
<div class="ttc" id="a_g_u_i_info_manager_8cpp_html_a59fe29cd9055981409819110c7b88cb5"><div class="ttname"><a href="../../d7/d66/_g_u_i_info_manager_8cpp.html#a59fe29cd9055981409819110c7b88cb5">pvr</a></div><div class="ttdeci">const infomap pvr[]</div><div class="ttdef"><b>Definition:</b> GUIInfoManager.cpp:7815</div></div>
<div class="ttc" id="agroup__python__xbmcvfs_html_ga07a90f3afa1401bd289deb4be40c2489"><div class="ttname"><a href="../../de/d51/group__python__xbmcvfs.html#ga07a90f3afa1401bd289deb4be40c2489">mkdir</a></div><div class="ttdeci">mkdir(...)</div><div class="ttdoc">&lt;h4&gt;&lt;code&gt;&lt;span style=&quot;font-style: italic;&quot;&gt;Function: &lt;/span&gt;&lt;span style=&quot;font-style: bold;&quot;&gt;&lt;font co...</div></div>
<div class="ttc" id="anamespacebuild_html"><div class="ttname"><a href="../../d9/d45/namespacebuild.html">build</a></div><div class="ttdef"><b>Definition:</b> build.py:1</div></div>
</div><!-- fragment --><p >It is recommended to specify the directories as absolute paths. If relative paths are used, they are considered relative to the build directory in which <code>cmake</code> was executed (the current working directory).</p>
<p >for add-on development and detailed documentation about the add-on build system.</p>
<h1><a class="anchor" id="autotoc_md113"></a>
Sanitizers</h1>
<p >Clang and GCC support different kinds of sanitizers. To enable a sanitizer, call CMake with the option &lsquo;-DECM_ENABLE_SANITIZERS=’san1;san2;...&rsquo;`. For more information about enabling the sanitizers, read the module <b><a href="../../modules/extra/ECMEnableSanitizers.cmake">documentation</a></b>.</p>
<p >It is also recommended to read the sections about sanitizers in the <a href="http://clang.llvm.org/docs/">Clang documentation</a>.</p>
<h1><a class="anchor" id="autotoc_md114"></a>
Debugging the build</h1>
<p >In order to see the exact compiler commands <code>make</code> and <code>nmake</code> can be executed with a <code>VERBOSE=1</code> parameter.</p>
<p >On Windows, this is unfortunately not enough because <code>nmake</code> uses temporary files to workaround <code>nmake</code>'s command string length limitations. In order to see verbose output the file <b><a href="https://github.com/Kitware/CMake/blob/master/Modules/Platform/Windows.cmake#L40">Modules/Platform/Windows.cmake</a></b> in the local CMake installation has to be adapted by uncommenting these lines: </p><div class="fragment"><div class="line">&lt;hr&gt;#set(CMAKE_START_TEMP_FILE <span class="stringliteral">&quot;&quot;</span>)</div>
<div class="line"><span class="preprocessor">#set(CMAKE_END_TEMP_FILE &quot;&quot;</span>)</div>
<div class="line">#set(CMAKE_VERBOSE_MAKEFILE 1)</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.9.2-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../d2/df6/building.html">2: Building</a></li>
    <li class="footer">Generated on Sun Dec 26 2021 17:33:20 for Kodi Docs by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.2 </li>
  </ul>
</div>
<script type="text/javascript">
  // script for doxygen 1.9.1
  $(function() {
    toggleButton = document.createElement('doxygen-awesome-dark-mode-toggle')
    toggleButton.title = "Toggle Light/Dark Mode"
    $(document).ready(function(){
      document.getElementById("MSearchBox").parentNode.appendChild(toggleButton)
    })
    $(window).resize(function(){
      document.getElementById("MSearchBox").parentNode.appendChild(toggleButton)
    })
  })
</script>
</body>
</html>
